/* ── Party Viewer Widget ── */

#dolmen-party-viewer {
	display: flex;
	flex-direction: column;
	align-items: flex-end;
	gap: 4px;
	pointer-events: auto;
}

/* ── Control Buttons ── */

.party-controls {
	display: flex;
	gap: 2px;
	width: 9rem;
	justify-content: space-between;
}

.party-ctrl-btn {
	width: 32px;
	height: 32px;
	display: flex;
	align-items: center;
	justify-content: center;
	padding: 0;
	border: 2px solid rgba(255, 255, 255, 0.12);
	border-top-color: rgba(255, 255, 255, 0.2);
	border-radius: 4px;
	background: linear-gradient(180deg, rgba(30, 28, 35, 0.75), rgba(10, 8, 15, 0.85));
	box-shadow:
		inset 0 1px 2px rgba(255, 255, 255, 0.05),
		inset 0 -2px 4px rgba(0, 0, 0, 0.3),
		0 2px 4px rgba(0, 0, 0, 0.3);
	color: rgba(255, 255, 255, 0.6);
	font-size: 13px;
	cursor: pointer;
	transition: color 0.15s ease, border-color 0.15s ease;
}

.party-ctrl-btn:hover {
	color: rgba(255, 255, 255, 0.9);
}

.party-ctrl-btn .fa-star {
	color: var(--dolmen-gold);
}

.party-ctrl-btn .fa-coins {
	color: var(--dolmen-gold);
}

.party-ctrl-btn .fa-user-plus {
	color: var(--dolmen-color-success);
}

.party-ctrl-btn .fa-user-xmark {
	color: var(--dolmen-color-failure);
}

/* ── Party Member List (vertical) ── */

.party-member-list {
	display: flex;
	flex-direction: column;
	gap: 3px;
	width: 9rem;
}

.party-member-list:empty {
	display: none;
}

/* ── Member Card ── */

.party-member-card {
	position: relative;
	display: flex;
	flex-direction: column;
	gap: 2px;
	padding: 4px 6px;
	background: linear-gradient(180deg, rgba(30, 28, 35, 0.75), rgba(10, 8, 15, 0.85));
	border: 2px solid rgba(255, 255, 255, 0.12);
	border-top-color: rgba(255, 255, 255, 0.2);
	border-radius: 4px;
	box-shadow:
		inset 0 1px 2px rgba(255, 255, 255, 0.05),
		inset 0 -2px 4px rgba(0, 0, 0, 0.3),
		0 2px 4px rgba(0, 0, 0, 0.3);
	cursor: pointer;
	transition: border-color 0.15s ease;
	overflow: hidden;
}

/* HP bar at bottom of card */
.party-hp-bar {
	position: absolute;
	bottom: 0;
	left: 0;
	right: 0;
	height: 3px;
	background: rgba(255, 255, 255, 0.06);
}

.party-hp-bar-fill {
	height: 100%;
	transition: width 0.3s ease, background-color 0.3s ease;
}

.party-hp-bar-fill.hp-healthy {
	background-color: rgba(100, 200, 100, 0.7);
}

.party-hp-bar-fill.hp-wounded {
	background-color: rgba(220, 180, 50, 0.7);
}

.party-hp-bar-fill.hp-critical {
	background-color: rgba(220, 60, 60, 0.8);
	animation: light-pulse 0.8s ease-in-out infinite;
}

.party-hp-bar-fill.hp-dead {
	background-color: rgba(120, 120, 120, 0.5);
}

.party-member-card:hover {
	border-color: rgba(255, 255, 255, 0.25);
}

/* Row 1: Name */
.party-name {
	font-size: 13px;
	font-weight: bold;
	color: rgba(255, 255, 255, 0.9);
	line-height: 1.2;
	max-width: 117px;
	overflow: hidden;
	text-overflow: ellipsis;
	white-space: nowrap;
	text-align: center;
}

/* Row 2-3: Portrait + Stats */
.party-body {
	display: flex;
	gap: 5px;
	align-items: center;
}

.party-portrait {
	width: 48px;
	height: 48px;
	border-radius: 3px;
	object-fit: cover;
	flex-shrink: 0;
	margin-left: -3px;
	margin-bottom: 3px;
}

.party-stats {
	display: flex;
	flex-direction: column;
	gap: 4px;
	font-size: 13px;
	color: rgba(255, 255, 255, 0.85);
}

.party-stats i {
	font-size: 12px;
	margin-right: 2px;
}

/* HP color states */
.party-hp.hp-healthy {
	color: rgba(100, 200, 100, 0.9);
}

.party-hp.hp-healthy i {
	color: rgba(100, 200, 100, 0.85);
}

.party-hp.hp-wounded {
	color: rgba(220, 180, 50, 0.9);
}

.party-hp.hp-wounded i {
	color: rgba(220, 180, 50, 0.85);
}

.party-hp.hp-critical {
	color: rgba(220, 60, 60, 0.9);
	animation: light-pulse 0.8s ease-in-out infinite;
}

.party-hp.hp-critical i {
	color: rgba(220, 60, 60, 0.85);
}

.party-hp.hp-dead {
	color: rgba(120, 120, 120, 0.9);
}

.party-hp.hp-dead i {
	color: rgba(120, 120, 120, 0.85);
}

.party-ac {
	color: rgba(140, 180, 220, 0.9);
}

.party-ac i {
	color: rgba(140, 180, 220, 0.85);
}

/* Name color coding by role */
.party-name.name-player {
	color: rgba(100, 200, 100, 0.9);
}

.party-name.name-retainer {
	color: rgb(234 214 98 / 90%);
}

.party-name.name-ally {
	color: rgb(166 166 166 / 90%);
}

/* Remove button */
.party-remove-btn {
	position: absolute;
	top: 2px;
	right: 2px;
	width: 18px;
	height: 18px;
	display: flex;
	align-items: center;
	justify-content: center;
	padding: 0;
	border: none;
	border-radius: 2px;
	background: transparent;
	color: rgba(255, 255, 255, 0.3);
	font-size: 12px;
	cursor: pointer;
	transition: color 0.15s ease, background 0.15s ease;
	opacity: 0;
}

.party-member-card:hover .party-remove-btn {
	opacity: 1;
}

.party-remove-btn:hover {
	color: rgba(220, 60, 60, 0.9);
	background: rgba(220, 60, 60, 0.15);
}

/* ── Distribute Preview (shared by XP and Coins dialogs) ── */

.distribute-preview {
	display: flex;
	flex-direction: column;
	gap: 2px;
	margin-top: 0.5rem;
	padding: 0.4rem 0.5rem;
	background: rgba(0, 0, 0, 0.08);
	border: 1px solid rgba(128, 128, 128, 0.2);
	border-radius: 4px;
}

.preview-row {
	display: flex;
	justify-content: space-between;
	align-items: center;
	font-size: 0.8rem;
	padding: 0.15rem 0;
}

.preview-name {
	flex: 1;
	min-width: 0;
	overflow: hidden;
	text-overflow: ellipsis;
	white-space: nowrap;
}

.xp-retainer-tag {
	font-size: 0.7rem;
	opacity: 0.6;
	font-style: italic;
}

.preview-amount,
.preview-coins {
	font-weight: bold;
	font-variant-numeric: tabular-nums;
	margin-left: 0.5rem;
	white-space: nowrap;
}

.preview-remainder {
	font-size: 0.75rem;
	font-style: italic;
	opacity: 0.7;
	margin-top: 0.25rem;
	text-align: center;
}

/* ── Coins Dialog ── */

.party-coins-row {
	display: flex;
	gap: 0.5rem;
}

.party-coin-cell {
	flex: 1;
	display: flex;
	flex-direction: column;
	align-items: center;
	gap: 0.25rem;
}

.party-coin-cell label {
	font-size: 1rem;
}

.party-coin-cell input {
	width: 100%;
	text-align: center;
}

.party-coin-cell .coin-copper {
	color: var(--dolmen-color-coin-copper, #a77445);
}

.party-coin-cell .coin-silver {
	color: var(--dolmen-color-coin-silver, #8e8e8e);
}

.party-coin-cell .coin-gold {
	color: var(--dolmen-color-coin-gold, #c5ac21);
}

.party-coin-cell .coin-pellucidium {
	color: var(--dolmen-color-coin-pellucidium, #c0eae5);
}

.party-denominate {
	margin-top: 0.35rem;
	font-size: 0.8rem;
}

.party-denominate label {
	display: flex;
	align-items: center;
	gap: 0.35rem;
	cursor: pointer;
}

/* ── Coin Summary Chat Card ── */

.coin-summary {
	gap: 2px;
	color: var(--dolmen-color-text);
}

.coin-summary-row {
	display: flex;
	justify-content: space-between;
	align-items: center;
	padding: 0.15rem 0;
	font-size: 0.8rem;
}

.coin-summary-name {
	flex: 1;
	min-width: 0;
	overflow: hidden;
	text-overflow: ellipsis;
	white-space: nowrap;
	color: var(--dolmen-color-h3);
}

.coin-summary-coins {
	font-weight: bold;
	font-variant-numeric: tabular-nums;
	margin-left: 0.5rem;
	white-space: nowrap;
}