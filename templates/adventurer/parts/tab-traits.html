<section class="tab-content tab-traits {{tab.cssClass}}" data-group="primary" data-tab="traits">
	{{#if isKindredClass}}
	<!-- Kindred-Class Traits (replaces both kindred and class traits) -->
	<section class="kindred-class-traits boxed-section">
		<h2>{{kindredClassName}} {{localize "DOLMEN.Traits.Title"}}</h2>
		<section class="two-columns traits-grid">
			{{#each kindredClassTraits}}
			<section class="trait boxed-section {{this.traitType}}" data-trait-id="{{this.id}}">
				<h3>
					{{this.name}}
					{{#if this.value}}
					<span class="trait-value">{{this.value}}</span>
					{{/if}}
					{{#if this.rollable}}
					<i class="fa fa-dice-d20 rollable" data-trait-id="{{this.id}}" data-roll-formula="{{this.rollFormula}}" data-trait-name="{{this.name}}" data-roll-target="{{this.rollTarget}}"></i>
					{{/if}}
				</h3>
				<p>{{this.description}}</p>
				{{#if this.hasUsageTracking}}
				<div class="trait-usage">
					<span class="usage-label">{{this.usageFrequency}}:</span>
					<div class="usage-checkboxes">
						{{#each this.usageCheckboxes}}
						<input type="checkbox" class="trait-usage-checkbox" data-trait-id="{{../id}}" data-usage-index="{{this.index}}" data-max-uses="{{../maxUses}}" {{#if this.checked}}checked{{/if}}>
						{{/each}}
					</div>
					<span class="uses-remaining">({{this.usesRemaining}} {{localize "DOLMEN.Traits.Remaining"}})</span>
				</div>
				{{/if}}
			</section>
			{{/each}}
		</section>
	</section>
	{{else}}
	<!-- Kindred Traits -->
	<section class="kindred-traits boxed-section">
		<h2>{{kindredName}} {{localize "DOLMEN.Traits.Title"}}</h2>
		<section class="two-columns traits-grid">
			{{#each kindredTraits}}
			<section class="trait boxed-section {{this.traitType}}" data-trait-id="{{this.id}}">
				<h3>
					{{this.name}}
					{{#if this.value}}
					<span class="trait-value">{{this.value}}</span>
					{{/if}}
					{{#if this.rollable}}
					<i class="fa fa-dice-d20 rollable" data-trait-id="{{this.id}}" data-roll-formula="{{this.rollFormula}}" data-trait-name="{{this.name}}" data-roll-target="{{this.rollTarget}}"></i>
					{{/if}}
				</h3>
				<p>{{this.description}}</p>
				{{#if this.hasUsageTracking}}
				<div class="trait-usage">
					<span class="usage-label">{{this.usageFrequency}}:</span>
					<div class="usage-checkboxes">
						{{#each this.usageCheckboxes}}
						<input type="checkbox" class="trait-usage-checkbox" data-trait-id="{{../id}}" data-usage-index="{{this.index}}" data-max-uses="{{../maxUses}}" {{#if this.checked}}checked{{/if}}>
						{{/each}}
					</div>
					<span class="uses-remaining">({{this.usesRemaining}} {{localize "DOLMEN.Traits.Remaining"}})</span>
				</div>
				{{/if}}
			</section>
			{{/each}}
		</section>
	</section>

	<!-- Class Traits -->
	<section class="class-traits boxed-section">
		<h2>{{className}} {{localize "DOLMEN.Traits.Title"}}</h2>
		<section class="two-columns traits-grid">
			{{#each classTraits}}
			<section class="trait boxed-section {{this.traitType}}" data-trait-id="{{this.id}}">
				<h3>
					{{this.name}}
					{{#if this.value}}
					<span class="trait-value">{{this.value}}</span>
					{{/if}}
					{{#if this.rollable}}
					<i class="fa fa-dice-d20 rollable" data-trait-id="{{this.id}}" data-roll-formula="{{this.rollFormula}}" data-trait-name="{{this.name}}" data-roll-target="{{this.rollTarget}}"></i>
					{{/if}}
				</h3>
				<p>{{this.description}}</p>
				{{#if this.hasUsageTracking}}
				<div class="trait-usage">
					<span class="usage-label">{{this.usageFrequency}}:</span>
					<div class="usage-checkboxes">
						{{#each this.usageCheckboxes}}
						<input type="checkbox" class="trait-usage-checkbox" data-trait-id="{{../id}}" data-usage-index="{{this.index}}" data-max-uses="{{../maxUses}}" {{#if this.checked}}checked{{/if}}>
						{{/each}}
					</div>
					<span class="uses-remaining">({{this.usesRemaining}} {{localize "DOLMEN.Traits.Remaining"}})</span>
				</div>
				{{/if}}
			</section>
			{{/each}}
		</section>
	</section>
	{{/if}}

	<!-- Custom Sections (Combat Talents, Holy Orders, etc.) -->
	{{#each customSections}}
	<section class="custom-section boxed-section">
		<h2>{{this.name}}</h2>
		<section class="two-columns traits-grid">
			{{#each this.slots}}
			<section class="trait boxed-section active">
				<h3>{{../name}}</h3>
				<div class="talent-select">
					<select name="system.{{../fieldName}}{{#if ../isMulti}}.{{this.index}}{{/if}}">
						{{selectOptions ../choices selected=this.selected}}
					</select>
				</div>
				{{#if this.description}}
				<p>{{this.description}}</p>
				{{/if}}
			</section>
			{{/each}}
		</section>
		{{#if this.showHint}}
		<div class="add-talent-hint">
			<small>{{localize this.hintKey}}</small>
		</div>
		{{/if}}
	</section>
	{{/each}}
</section>